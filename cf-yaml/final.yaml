version: "1.0"
kind: pipeline
metadata:
  name: emburse/Parallel Clone
  project: emburse
  projectId: 619a033e9ff69ea33586daff
  revision: 6
  accountId: 612c9a543ba6265134394298
  created_at: "2021-12-16T13:10:26.609Z"
  updated_at: "2021-12-20T16:08:53.023Z"
  shortName: parallel clone
  deprecate: {}
  originalYamlString: |+
    # More examples of Codefresh YAML can be found at
    # https://codefresh.io/docs/docs/yaml-examples/examples/

    version: "1.0"
    # Stages can help you organize your steps in stages
    stages:
      - "clone"
      - "build"
      - "test"

    steps:
      clone:
        title: "Cloning repository"
        type: "git-clone"
        repo: "${{CF_REPO_OWNER}}/${{CF_REPO_NAME}}"
        # CF_BRANCH value is auto set when pipeline is triggered
        # Learn more at codefresh.io/docs/docs/codefresh-yaml/variables/
        revision: "${{CF_BRANCH}}"
        git: "Codefresh"
        stage: "clone"

      build:
        title: "Building Docker image"
        type: "build"
        image_name: "olegcf/mariadb"
        working_directory: "${{clone}}"
        tag: "${{CF_BRANCH_TAG_NORMALIZED}}"
        dockerfile: "Dockerfile"
        stage: "build"

      test:
        title: "Running test"
        type: "freestyle" # Run any command
        image: "ubuntu:latest" # The image in which command will be executed
        working_directory: "${{clone}}" # Running command where code cloned
        commands:
          - "ls"
        stage: "test"

  id: 61bb3ac293c1e6d8ce1136b0
spec:
  triggers:
    - name: olegcf/mariadb
      type: git
      repo: olegcf/mariadb
      events:
        - push.heads
      pullRequestAllowForkEvents: false
      commentRegex: /.*/gi
      branchRegex: /.*/gi
      branchRegexInput: regex
      provider: github
      disabled: false
      options:
        noCache: false
        noCfCache: false
        resetVolume: false
      context: Codefresh
      contexts: []
      verified: true
      status: verified
      id: 61bb3ac393c1e60ea31136b1
  variables: []
  contexts: []
  specTemplate:
    location: git
    repo: codefresh-support/cf-utils
    path: ./cf-yaml/clone-in-parallel.yaml
    revision: emburse
    context: Codefresh
    steps:
      clone:
        title: Cloning repository
        type: git-clone
        repo: olegcf/mariadb
        revision: master
        git: Codefresh-other
        stage: clone
  steps:
    clone:
      title: Cloning repository
      type: git-clone
      repo: ${{CF_REPO_OWNER}}/${{CF_REPO_NAME}}
      revision: ${{CF_BRANCH}}
      git: Codefresh
      stage: clone
    build:
      title: Building Docker image
      type: build
      image_name: olegcf/mariadb
      working_directory: ${{clone}}
      tag: ${{CF_BRANCH_TAG_NORMALIZED}}
      dockerfile: Dockerfile
      stage: build
    test:
      title: Running test
      type: freestyle
      image: ubuntu:latest
      working_directory: ${{clone}}
      commands:
        - ls
      stage: test
  stages: []
